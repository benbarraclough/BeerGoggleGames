---
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const games = await getCollection('games');
  const types = [...new Set(games.map(g => g.data.type).filter(Boolean))];
  return types.map(type => ({ params: { type }, props: { type } }));
}

const { type } = Astro.props;
const games = (await getCollection('games'))
  .filter(g => g.data.type === type)
  .sort((a,b)=> a.data.title.localeCompare(b.data.title));
---
<html lang="en">
  <head><title>{type} Games</title></head>
  <body>
    <h1>{type} Games</h1>
    <ul>
      {games.map(g => <li><a href={`/games/${g.slug}/`}>{g.data.title}</a></li>)}
    </ul>
    <p><a href="/games/types/">All Types</a></p>
  </body>
</html>
