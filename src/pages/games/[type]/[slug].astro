---
import Layout from '../../../components/Layout.astro';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const items = await getCollection('games');
  return items.map((item) => {
    const type = item.data.type || 'misc';
    const slug = (item.slug ?? item.id).split('/').pop();
    return { params: { type, slug }, props: { item } };
  });
}
const { item } = Astro.props;
const d = item.data;
const base = import.meta.env.BASE_URL || '/';
const { Content } = await item.render();
---
<Layout title={d.title}>
  <article class="prose prose-invert max-w-none">
    <h1 class="font-display text-3xl">{d.title}</h1>
    {d.cover && <img class="my-4 max-w-full border border-fg/20" src={`${base}${d.cover}`} alt={d.title} />}
    {d.players && <div class="text-sm text-muted mb-2">Players: {d.players}</div>}
    {d.equipment?.length ? (
      <>
        <h2 class="font-semibold">Equipment</h2>
        <ul class="list-disc pl-5 mb-4">{d.equipment.map(x => <li>{x}</li>)}</ul>
      </>
    ) : null}
    {d.tags?.length ? <div class="text-xs text-muted mb-4">{d.tags.join(' â€¢ ')}</div> : null}
    <Content />
  </article>
</Layout>
